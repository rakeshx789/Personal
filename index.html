<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Navaratri 2025 Invitation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #ff6b6b, #ffa500, #ff1493);
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: white;
      margin-bottom: 10px;
    }
    .upload-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      background: #ff5722;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
    .upload-btn:hover {
      background: #e64a19;
    }
    canvas {
      margin-top: 20px;
      max-width: 100%;
      border: 4px solid white;
      border-radius: 20px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    .download-btn {
      margin-top: 15px;
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      background: #4CAF50;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
    .download-btn:hover {
      background: #388E3C;
    }
  </style>
  <!-- Stylish font for name -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
</head>
<body>
  <h1>ðŸŒ¸ Navaratri 2025 Invitation Generator ðŸŒ¸</h1>
  <p>Select your photo and generate a beautiful invitation instantly</p>

  <input type="file" id="fileInput" accept="image/*" style="display:none">
  <button class="upload-btn" onclick="document.getElementById('fileInput').click()">ðŸ“¤ Upload Photo</button>

  <div id="preview"></div>

  <script>
    const templateSrc = "template.png"; // fixed background

    document.getElementById("fileInput").addEventListener("change", handleFile);

    function handleFile(event) {
      const file = event.target.files[0];
      if (!file) return;

      const name = file.name.split(".")[0]; // name from filename
      const reader = new FileReader();
      reader.onload = function(e) {
        generateInvitation(e.target.result, name);
      };
      reader.readAsDataURL(file);
    }

    function generateInvitation(photoSrc, name) {
      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");
      const template = new Image();
      template.src = templateSrc;

      template.onload = function() {
        canvas.width = template.width;
        canvas.height = template.height;

        // Draw template background
        ctx.drawImage(template, 0, 0);

        // Load user photo
        const photo = new Image();
        photo.src = photoSrc;
        photo.onload = function() {
          // Position values match the frame area on template
          const frameX = 1000;  // adjust if needed
          const frameY = 220;
          const frameW = 400;
          const frameH = 500;

          // Clip into rounded rectangle
          ctx.save();
          roundRect(ctx, frameX, frameY, frameW, frameH, 40);
          ctx.clip();
          ctx.drawImage(photo, frameX, frameY, frameW, frameH);
          ctx.restore();

          // Write name in blue brush area
          ctx.font = "60px 'Great Vibes', cursive";
          ctx.fillStyle = "white";
          ctx.textAlign = "center";
          ctx.fillText(name, frameX + frameW/2, frameY + frameH + 100);

          // Show preview + download
          showResult(canvas, name);
        };
      };
    }

    function roundRect(ctx, x, y, width, height, radius) {
      ctx.beginPath();
      ctx.moveTo(x + radius, y);
      ctx.lineTo(x + width - radius, y);
      ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
      ctx.lineTo(x + width, y + height - radius);
      ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
      ctx.lineTo(x + radius, y + height);
      ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
      ctx.lineTo(x, y + radius);
      ctx.quadraticCurveTo(x, y, x + radius, y);
      ctx.closePath();
    }

    function showResult(canvas, name) {
      const preview = document.getElementById("preview");
      preview.innerHTML = "";
      preview.appendChild(canvas);

      const btn = document.createElement("button");
      btn.className = "download-btn";
      btn.innerText = "ðŸ“¥ Download Invitation";
      btn.onclick = () => {
        const link = document.createElement("a");
        link.download = name + "_Navaratri_Invitation.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
      };
      preview.appendChild(btn);
    }
  </script>
</body>
</html>
